# ==================================================================
# QUANTUM'S GRAFANA DASHBOARDS
# Real-time visualization with predictive analytics
# ==================================================================

apiVersion: v1
kind: ConfigMap
metadata:
  name: astral-turf-business-dashboard
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
    app.kubernetes.io/name: grafana
data:
  astral-turf-business.json: |
    {
      "dashboard": {
        "id": null,
        "title": "Astral Turf - Business KPIs",
        "tags": ["astral-turf", "business", "kpi"],
        "style": "dark",
        "timezone": "browser",
        "refresh": "30s",
        "time": {
          "from": "now-1h",
          "to": "now"
        },
        "panels": [
          {
            "id": 1,
            "title": "Active Tactical Sessions",
            "type": "stat",
            "targets": [
              {
                "expr": "business:tactical_sessions:rate5m * 60",
                "legendFormat": "Sessions/min"
              }
            ],
            "fieldConfig": {
              "defaults": {
                "color": {"mode": "thresholds"},
                "thresholds": {
                  "steps": [
                    {"color": "red", "value": 0},
                    {"color": "yellow", "value": 30},
                    {"color": "green", "value": 100}
                  ]
                },
                "unit": "short"
              }
            },
            "gridPos": {"h": 8, "w": 6, "x": 0, "y": 0}
          },
          {
            "id": 2,
            "title": "User Engagement Score",
            "type": "gauge",
            "targets": [
              {
                "expr": "business:user_engagement:avg5m",
                "legendFormat": "Engagement"
              }
            ],
            "fieldConfig": {
              "defaults": {
                "min": 0,
                "max": 1,
                "color": {"mode": "thresholds"},
                "thresholds": {
                  "steps": [
                    {"color": "red", "value": 0},
                    {"color": "yellow", "value": 0.5},
                    {"color": "green", "value": 0.8}
                  ]
                }
              }
            },
            "gridPos": {"h": 8, "w": 6, "x": 6, "y": 0}
          },
          {
            "id": 3,
            "title": "Real-time Collaborations",
            "type": "timeseries",
            "targets": [
              {
                "expr": "performance:websocket_connections:current",
                "legendFormat": "WebSocket Connections"
              }
            ],
            "fieldConfig": {
              "defaults": {
                "color": {"mode": "palette-classic"},
                "custom": {
                  "drawStyle": "line",
                  "lineInterpolation": "smooth",
                  "pointSize": 3
                }
              }
            },
            "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0}
          },
          {
            "id": 4,
            "title": "Service Level Indicators",
            "type": "table",
            "targets": [
              {
                "expr": "sli:availability:ratio5m",
                "legendFormat": "Availability",
                "format": "table",
                "instant": true
              },
              {
                "expr": "sli:latency:p99_5m * 1000",
                "legendFormat": "P99 Latency (ms)",
                "format": "table",
                "instant": true
              },
              {
                "expr": "sli:error_rate:ratio5m * 100",
                "legendFormat": "Error Rate (%)",
                "format": "table",
                "instant": true
              }
            ],
            "transformations": [
              {
                "id": "seriesToColumns",
                "options": {
                  "byField": "Time"
                }
              }
            ],
            "fieldConfig": {
              "defaults": {
                "custom": {
                  "displayMode": "color-background"
                },
                "thresholds": {
                  "steps": [
                    {"color": "green", "value": null},
                    {"color": "red", "value": 0.99}
                  ]
                }
              },
              "overrides": [
                {
                  "matcher": {"id": "byName", "options": "Error Rate (%)"},
                  "properties": [
                    {
                      "id": "thresholds",
                      "value": {
                        "steps": [
                          {"color": "green", "value": null},
                          {"color": "yellow", "value": 0.05},
                          {"color": "red", "value": 0.1}
                        ]
                      }
                    }
                  ]
                }
              ]
            },
            "gridPos": {"h": 8, "w": 24, "x": 0, "y": 8}
          }
        ]
      }
    }

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: astral-turf-infrastructure-dashboard
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
    app.kubernetes.io/name: grafana
data:
  astral-turf-infrastructure.json: |
    {
      "dashboard": {
        "id": null,
        "title": "Astral Turf - Infrastructure Monitoring",
        "tags": ["astral-turf", "infrastructure", "kubernetes"],
        "style": "dark",
        "timezone": "browser",
        "refresh": "15s",
        "time": {
          "from": "now-30m",
          "to": "now"
        },
        "panels": [
          {
            "id": 1,
            "title": "Pod Scaling Status",
            "type": "timeseries",
            "targets": [
              {
                "expr": "kube_deployment_status_replicas{deployment=\"astral-turf-app\"}",
                "legendFormat": "Current Replicas"
              },
              {
                "expr": "kube_deployment_spec_replicas{deployment=\"astral-turf-app\"}",
                "legendFormat": "Desired Replicas"
              }
            ],
            "fieldConfig": {
              "defaults": {
                "color": {"mode": "palette-classic"},
                "custom": {
                  "drawStyle": "line",
                  "lineWidth": 2,
                  "pointSize": 5
                }
              }
            },
            "gridPos": {"h": 8, "w": 12, "x": 0, "y": 0}
          },
          {
            "id": 2,
            "title": "Resource Utilization",
            "type": "timeseries",
            "targets": [
              {
                "expr": "rate(container_cpu_usage_seconds_total{pod=~\"astral-turf-app-.*\"}[5m]) * 100",
                "legendFormat": "CPU Usage %"
              },
              {
                "expr": "container_memory_usage_bytes{pod=~\"astral-turf-app-.*\"} / 1024 / 1024 / 1024",
                "legendFormat": "Memory Usage (GB)"
              }
            ],
            "fieldConfig": {
              "defaults": {
                "color": {"mode": "palette-classic"},
                "unit": "percent"
              }
            },
            "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0}
          },
          {
            "id": 3,
            "title": "Database Performance",
            "type": "timeseries",
            "targets": [
              {
                "expr": "performance:database_pool:utilization * 100",
                "legendFormat": "Connection Pool %"
              },
              {
                "expr": "rate(postgresql_queries_total[5m])",
                "legendFormat": "Queries/sec"
              }
            ],
            "fieldConfig": {
              "defaults": {
                "color": {"mode": "palette-classic"},
                "unit": "percent"
              }
            },
            "gridPos": {"h": 8, "w": 12, "x": 0, "y": 8}
          },
          {
            "id": 4,
            "title": "Cache Performance",
            "type": "stat",
            "targets": [
              {
                "expr": "performance:cache_hit_ratio:5m * 100",
                "legendFormat": "Cache Hit Rate %"
              }
            ],
            "fieldConfig": {
              "defaults": {
                "color": {"mode": "thresholds"},
                "thresholds": {
                  "steps": [
                    {"color": "red", "value": 0},
                    {"color": "yellow", "value": 85},
                    {"color": "green", "value": 95}
                  ]
                },
                "unit": "percent"
              }
            },
            "gridPos": {"h": 8, "w": 12, "x": 12, "y": 8}
          }
        ]
      }
    }

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: astral-turf-slo-dashboard
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
    app.kubernetes.io/name: grafana
data:
  astral-turf-slo.json: |
    {
      "dashboard": {
        "id": null,
        "title": "Astral Turf - SLO Monitoring",
        "tags": ["astral-turf", "slo", "sli", "reliability"],
        "style": "dark",
        "timezone": "browser",
        "refresh": "10s",
        "time": {
          "from": "now-24h",
          "to": "now"
        },
        "panels": [
          {
            "id": 1,
            "title": "99.99% Availability SLO",
            "type": "stat",
            "targets": [
              {
                "expr": "avg_over_time(sli:availability:ratio5m[24h]) * 100",
                "legendFormat": "24h Availability %"
              }
            ],
            "fieldConfig": {
              "defaults": {
                "color": {"mode": "thresholds"},
                "thresholds": {
                  "steps": [
                    {"color": "red", "value": 0},
                    {"color": "yellow", "value": 99.9},
                    {"color": "green", "value": 99.99}
                  ]
                },
                "unit": "percent",
                "decimals": 3
              }
            },
            "gridPos": {"h": 8, "w": 6, "x": 0, "y": 0}
          },
          {
            "id": 2,
            "title": "Error Budget Consumption",
            "type": "gauge",
            "targets": [
              {
                "expr": "(1 - avg_over_time(sli:availability:ratio5m[24h])) / 0.0001 * 100",
                "legendFormat": "Error Budget Used %"
              }
            ],
            "fieldConfig": {
              "defaults": {
                "min": 0,
                "max": 100,
                "color": {"mode": "thresholds"},
                "thresholds": {
                  "steps": [
                    {"color": "green", "value": 0},
                    {"color": "yellow", "value": 50},
                    {"color": "red", "value": 90}
                  ]
                },
                "unit": "percent"
              }
            },
            "gridPos": {"h": 8, "w": 6, "x": 6, "y": 0}
          },
          {
            "id": 3,
            "title": "P99 Latency SLO Tracking",
            "type": "timeseries",
            "targets": [
              {
                "expr": "sli:latency:p99_5m * 1000",
                "legendFormat": "P99 Latency (ms)"
              },
              {
                "expr": "vector(100)",
                "legendFormat": "SLO Threshold (100ms)"
              }
            ],
            "fieldConfig": {
              "defaults": {
                "color": {"mode": "palette-classic"},
                "unit": "ms",
                "custom": {
                  "drawStyle": "line",
                  "lineWidth": 2
                }
              },
              "overrides": [
                {
                  "matcher": {"id": "byName", "options": "SLO Threshold (100ms)"},
                  "properties": [
                    {
                      "id": "color",
                      "value": {"mode": "fixed", "fixedColor": "red"}
                    },
                    {
                      "id": "custom.lineStyle",
                      "value": {"dash": [10, 10]}
                    }
                  ]
                }
              ]
            },
            "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0}
          },
          {
            "id": 4,
            "title": "Monthly SLO Compliance",
            "type": "table",
            "targets": [
              {
                "expr": "avg_over_time(sli:availability:ratio5m[30d]) * 100",
                "legendFormat": "30-day Availability",
                "format": "table",
                "instant": true
              },
              {
                "expr": "quantile_over_time(0.99, sli:latency:p99_5m[30d]) * 1000",
                "legendFormat": "30-day P99 Latency (ms)",
                "format": "table",
                "instant": true
              },
              {
                "expr": "avg_over_time(sli:error_rate:ratio5m[30d]) * 100",
                "legendFormat": "30-day Error Rate (%)",
                "format": "table",
                "instant": true
              }
            ],
            "fieldConfig": {
              "defaults": {
                "custom": {
                  "displayMode": "color-background"
                }
              }
            },
            "gridPos": {"h": 8, "w": 24, "x": 0, "y": 8}
          }
        ]
      }
    }